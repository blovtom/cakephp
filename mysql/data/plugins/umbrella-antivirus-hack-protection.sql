insert into plugins (id, name, testedUpTo, stableTag, requiresAtLeast, created, modified) values (4544, "Umbrella", "4.1.1", "1.3", "3.0.1", now(), now());
insert into functions (id, plugin_id, function_name, function_loc, created, modified) values (79672, 4544, "rkwpa_hide_version", "/src/modules/hide_version.php", now(), now());
insert into functions (id, plugin_id, function_name, function_loc, created, modified) values (79673, 4544, "remove_wp_ver_par", "/src/modules/hide_version.php", now(), now());
insert into functions (id, plugin_id, function_name, function_loc, created, modified) values (79674, 4544, "wpbeginner_remove_version", "/src/modules/hide_version.php", now(), now());
insert into functions (id, plugin_id, function_name, function_loc, created, modified) values (79675, 4544, "is_forbidden", "/src/modules/filter_requests.php", now(), now());
insert into functions (id, plugin_id, function_name, function_loc, created, modified) values (79676, 4544, "arr2ini", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564983, 4544, "Scanner", "sort", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564984, 4544, "Autoload", "__construct", "/src/autoload.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564985, 4544, "Scanner", "reinstall_file", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564986, 4544, "Log", "checkDatabaseTable", "/src/logging.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564987, 4544, "Autoload", "init", "/src/autoload.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564988, 4544, "Controller", "logging", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564989, 4544, "Controller", "vulnerabilities", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564990, 4544, "Controller", "make", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564991, 4544, "Scanner", "remove_file", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564992, 4544, "Scanner", "vulndb_plugins_errors", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564993, 4544, "Autoload", "admin_init", "/src/autoload.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564994, 4544, "Scanner", "check_file", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564995, 4544, "Scanner", "update_core_whitelist", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564996, 4544, "Log", "read", "/src/logging.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564997, 4544, "Scanner", "vulndb_themes", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564998, 4544, "Scanner", "api_get_files", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (564999, 4544, "Scanner", "ignore_file", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565000, 4544, "Scanner", "has_cloudflare", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565001, 4544, "Scanner", "google_safe_browsing_code", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565002, 4544, "Scanner", "wp_version", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565003, 4544, "Autoload", "plugins_loaded", "/src/autoload.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565004, 4544, "Scanner", "vulndb_plugins", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565005, 4544, "Modules", "validate_modules", "/src/modules.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565006, 4544, "Controller", "footer", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565007, 4544, "Scanner", "compare_file", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565008, 4544, "Controller", "scanner", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565009, 4544, "Controller", "permissions", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565010, 4544, "Scanner", "progressbar", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565011, 4544, "Scanner", "list_core_files", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565012, 4544, "Modules", "valid_modules", "/src/modules.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565013, 4544, "Log", "write", "/src/logging.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565014, 4544, "Whois", "whoislookup", "/lib/whois.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565015, 4544, "Autoload", "admin_menu", "/src/autoload.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565016, 4544, "Scanner", "reverse_ip", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565017, 4544, "Controller", "dashboard", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565018, 4544, "Controller", "header", "/src/controller.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565019, 4544, "Autoload", "load_modules", "/src/autoload.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565020, 4544, "Scanner", "monitor_files_list", "/lib/scanner.lib.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565021, 4544, "Autoload", "autoload", "/src/autoload.class.php", now(), now());
insert into methods (id, plugin_id, class_name, method_name, method_loc, created, modified) values (565022, 4544, "Scanner", "whitelist", "/lib/scanner.lib.php", now(), now());
insert into hooks (id, plugin_id, hook_name, hook_callback, hook_priority, created, modified) values (48843, 4544, "wp", "function ()
{
	remove_action('wp_head','rsd_link');
}", 9, now(), now());
insert into hooks (id, plugin_id, hook_name, hook_callback, hook_priority, created, modified) values (48844, 4544, "login_form", "function ()
{
	if(class_exists('ReallySimpleCaptcha')) {
	$captcha_instance = (new ReallySimpleCaptcha());
	$word = $captcha_instance->generate_random_word();
	$prefix = mt_rand();
	$captchaimg = $captcha_instance->generate_image($prefix,$word);
	$imgpath = ((plugins_url() . '/really-simple-captcha/tmp/') . $captchaimg);
	echo('<input type='hidden' name='umbrella_captcha_prefix' value=''.$prefix.''/>');
	echo('<img src=''.$imgpath.'' style='float: right;position: absolute;margin-left: 190px;margin-top: 11px;' /><input name='umbrella_captcha_text' type='text' />');
}
}", 10, now(), now());
insert into hooks (id, plugin_id, hook_name, hook_callback, hook_priority, created, modified) values (48845, 4544, "admin_init", "function ()
{
	if(((current_user_can('administrator') and isset($_GET['page'])) and ($_GET['page'] == 'umbrella-scanner'))) {
	if(isset($_GET['action'])) {
		$scanner = (new Scanner());
		switch($_GET['action']) {
			case 'remove':
			$scanner->remove_file($_GET['file']);break;case 'ignore':
			$scanner->ignore_file($_GET['file']);break;case 'reinstall':
			$scanner->reinstall_file($_GET['file']);break;case 'compare':
			$scanner->compare_file($_GET['file']);break;case 'get_files':
			$scanner->api_get_files();break;case 'check_file':
			echo(json_encode($scanner->check_file($_GET['file'])));exit();break;
		}
	}
}
}", 10, now(), now());
insert into hooks (id, plugin_id, hook_name, hook_callback, hook_priority, created, modified) values (48846, 4544, "init", "function ()
{
	load_plugin_textdomain(UMBRELLA__TEXTDOMAIN,false,(UMBRELLA__TEXTDOMAIN . '/languages'));
}", 10, now(), now());
insert into hooks (id, plugin_id, hook_name, hook_callback, hook_priority, created, modified) values (48847, 4544, "xmlrpc_call", "function ($method)
{
	if(($method != 'pingback.ping')) {
	return;
}Umbrella::Log::write('Disable Ping Module','Blocked pingback ping');wp_die('Pingback functionality is disabled on this Blog.','Pingback Disabled!',array('response' => 403));
}", 10, now(), now());
insert into hooks (id, plugin_id, hook_name, hook_callback, hook_priority, created, modified) values (48848, 4544, "init", "'rkwpa_hide_version'", 10, now(), now());
insert into filters (id, plugin_id, tag_name, filter_callback, filter_priority, created, modified) values (16410, 4544, "style_loader_src", "'remove_wp_ver_par'", 9999, now(), now());
insert into filters (id, plugin_id, tag_name, filter_callback, filter_priority, created, modified) values (16411, 4544, "the_generator", "'wpbeginner_remove_version'", 10, now(), now());
insert into filters (id, plugin_id, tag_name, filter_callback, filter_priority, created, modified) values (16412, 4544, "wp_authenticate_user", "function ($user,$password)
{
	$return_value = $user;if(class_exists('ReallySimpleCaptcha')) {
	$captcha_instance = (new ReallySimpleCaptcha());
	$prefix = $_POST['umbrella_captcha_prefix'];
	if(!$captcha_instance->check($prefix,$_POST['umbrella_captcha_text'])) {
		$user_login = $user->user_login;
		Umbrella::Log::write('Captcha Login','Blocked login attempt with captcha error for user: '.$user_login.' ');
		$return_value = (new WP_Error('loginCaptchaError','Captcha Error. Please try again.'));
	}
	$captcha_instance->remove($prefix);
}return $return_value;
}", 10, now(), now());
insert into filters (id, plugin_id, tag_name, filter_callback, filter_priority, created, modified) values (16413, 4544, "script_loader_src", "'remove_wp_ver_par'", 9999, now(), now());
insert into filters (id, plugin_id, tag_name, filter_callback, filter_priority, created, modified) values (16414, 4544, "wp_headers", "function ($headers,$wp_query)
{
	if(isset($headers['X-Pingback'])) {
	unset($headers['X-Pingback']);
}return $headers;
}", 11, now(), now());
insert into filters (id, plugin_id, tag_name, filter_callback, filter_priority, created, modified) values (16415, 4544, "pre_option_enable_xmlrpc", "function ($state)
{
	return '0';
}", 10, now(), now());
insert into filters (id, plugin_id, tag_name, filter_callback, filter_priority, created, modified) values (16416, 4544, "bloginfo_url", "function ($output,$property)
{
	return ($property == 'pingback_url')?null:$output;
}", 11, now(), now());